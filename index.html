<!DOCTYPE html>
<html lang="en">
	<head>
		<!-- Required meta tags always come first -->
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<meta http-equiv="x-ua-compatible" content="ie=edge">

		<link rel="stylesheet" href="https://bootswatch.com/cosmo/bootstrap.min.css">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/handsontable/0.26.1/handsontable.full.min.css">
		<script src="https://code.jquery.com/jquery-3.1.0.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/handsontable/0.26.1/handsontable.full.min.js"></script>
	</head>

	<body>
		<div id="csv"></div>
		<button id="csv-generate">Generate URLs</button>
	</body>

	<script>
		var colHeaders = ['First Name', 'Last Name', 'Email', 'Phone', 'URL'];
		var paramNames = ['first', 'last', 'email', 'phone'];
		var csvTable = new Handsontable(document.getElementById('csv'), {
			colHeaders: colHeaders,
			rowHeaders: true
		});

		$(document).ready(function() {
			$('#csv-generate').click(function() {
				data = csvTable.getData();
				for (var i = 0; i < data.length; i++) {
					var row = data[i];
					var url = 'http://www.sn-fg.com/?';
					var isFirst = true;
					for (var j = 0; j < row.length - 1; j++) {
						if (isFirst && row[j]) {
							// no & on first parameter
							url += paramNames[j] + '=' + row[j];
							isFirst = false;
						} else if (row[j]) {
							url += '&' + paramNames[j] + '=' + row[j];
						}
					}

					// last element, generate URL for row
					if (j == row.length - 1) {
						csvTable.setDataAtCell(i, j, url);
					}
				}
				csvTable.render();
			});
		});
	</script>

</html>